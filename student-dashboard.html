<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOCTORLY - Student Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --medical-primary: #0891b2;
            --medical-secondary: #0e7490;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(152deg, #f0fdfa 0%, #ecfeff 100%);
        }

        .medical-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-radius: 1.5rem;
            box-shadow: 0 8px 32px rgba(8, 145, 178, 0.1);
            border: 1px solid rgba(8, 145, 178, 0.1);
        }

        .video-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            margin-top: 1rem;
        }

        video {
            width: 100%;
            max-width: 400px;
            border-radius: 1rem;
            background: #000;
        }
    </style>
</head>
<body class="min-h-screen text-slate-800">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <header class="flex items-center justify-between mb-12">
            <h1 class="text-3xl font-bold text-slate-800">DOCTORLY MD</h1>
            <button onclick="showUploads()" class="medical-card px-6 py-2.5 bg-[var(--medical-primary)] text-white hover:bg-[var(--medical-secondary)] transition-colors">
                üìö View Uploads
            </button>
        </header>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Uploaded Content -->
            <div class="medical-card p-6">
                <h2 class="text-xl font-semibold mb-6 text-slate-800">üìö Uploaded Content</h2>
                <div id="uploads-list" class="grid grid-cols-1 gap-4"></div>
            </div>

            <!-- Student Profile -->
            <div class="medical-card p-6">
                <h2 class="text-xl font-semibold mb-6 text-slate-800">üë§ Student Profile</h2>
                <div class="mb-6">
                    <h3 class="font-semibold mb-3">üìù Internship Application</h3>
                    <div class="grid grid-cols-1 gap-3">
                        <input type="text" id="student-name" class="medical-card p-2" placeholder="Your Name">
                        <input type="text" id="student-email" class="medical-card p-2" placeholder="Your Email">
                        <textarea id="student-bio" class="medical-card p-2" placeholder="Your Bio"></textarea>
                        <button onclick="submitApplication()" class="medical-card bg-[var(--medical-primary)] text-white p-2 hover:bg-[var(--medical-secondary)]">
                            Submit Application
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Call Section -->
        <div class="medical-card p-6 mt-8">
            <h2 class="text-xl font-semibold mb-6 text-slate-800">üìû Live Video Call</h2>
            <div class="video-container">
                <video id="localVideo" autoplay muted></video>
                <video id="remoteVideo" autoplay></video>
            </div>
            <div class="flex gap-4 mt-4">
                <button onclick="startCall()" class="medical-card bg-[var(--medical-primary)] text-white p-2 hover:bg-[var(--medical-secondary)]">
                    Start Call
                </button>
                <button onclick="endCall()" class="medical-card bg-red-500 text-white p-2 hover:bg-red-600">
                    End Call
                </button>
            </div>
        </div>

        <!-- Student Applications -->
        <div class="medical-card p-6 mt-8">
            <h2 class="text-xl font-semibold mb-6 text-slate-800">üë§ Student Applications</h2>
            <div id="student-applications" class="grid grid-cols-1 gap-4"></div>
        </div>

        <!-- Search Student Profiles -->
        <div class="medical-card p-6 mt-8">
            <h2 class="text-xl font-semibold mb-6 text-slate-800">üîç Search Student Profiles</h2>
            <input type="text" id="search-box" class="medical-card p-2 w-full mb-4" placeholder="Search by name or email">
            <div id="search-results" class="grid grid-cols-1 gap-4"></div>
        </div>
    </div>

    <!-- Uploads Modal -->
    <div id="uploads-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center p-4">
        <div class="medical-card p-6 w-full max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold">View Uploads</h3>
                <button onclick="hideUploads()" class="medical-card p-2 hover:bg-slate-50 rounded-lg">‚úï</button>
            </div>
            <div id="uploads-content" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </div>
    </div>

    <script>
        let uploads = [
            { id: 'u001', type: 'video', title: "Introduction to Cardiology", url: "https://example.com/video1.mp4", uploadedBy: "Dr. John Doe" },
            { id: 'u002', type: 'document', title: "Medical Ethics Handbook", url: "https://example.com/doc1.pdf", uploadedBy: "Dr. Sarah Smith" },
            { id: 'u003', type: 'book', title: "Anatomy and Physiology", url: "https://example.com/book1.pdf", uploadedBy: "Dr. John Doe" }
        ];

        // WebRTC variables
        let localStream;
        let remoteStream;
        let peerConnection;

        const servers = {
            iceServers: [
                {
                    urls: ['stun:stun1.l.google.com:19302', 'stun:stun2.l.google.com:19302']
                }
            ]
        };

        const localVideo = document.getElementById('localVideo');
        const remoteVideo = document.getElementById('remoteVideo');

        async function startCall() {
            localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
            remoteStream = new MediaStream();

            localVideo.srcObject = localStream;
            remoteVideo.srcObject = remoteStream;

            // Create peer connection
            peerConnection = new RTCPeerConnection(servers);

            localStream.getTracks().forEach(track => {
                peerConnection.addTrack(track, localStream);
            });

            peerConnection.ontrack = event => {
                event.streams[0].getTracks().forEach(track => {
                    remoteStream.addTrack(track);
                });
            };

            // Create offer
            const offer = await peerConnection.createOffer();
            await peerConnection.setLocalDescription(offer);

            // Simulate sending the offer to the other peer (doctor)
            // In a real application, you would send this offer to the doctor via a signaling server
            console.log('Offer created:', offer);
        }

        function endCall() {
            localStream.getTracks().forEach(track => track.stop());
            if (remoteStream) remoteStream.getTracks().forEach(track => track.stop());
            if (peerConnection) peerConnection.close();

            localVideo.srcObject = null;
            remoteVideo.srcObject = null;
        }

        function showUploads() {
            document.getElementById('uploads-modal').classList.remove('hidden');
        }

        function hideUploads() {
            document.getElementById('uploads-modal').classList.add('hidden');
        }

        function submitApplication() {
            const name = document.getElementById('student-name').value;
            const email = document.getElementById('student-email').value;
            const bio = document.getElementById('student-bio').value;

            if(name && email && bio) {
                let applications = JSON.parse(localStorage.getItem('student-applications')) || [];
                applications.push({ name, email, bio, status: 'pending' });
                localStorage.setItem('student-applications', JSON.stringify(applications));
                alert('Application submitted successfully!');
                loadStudentApplications();
            } else {
                alert('Please fill in all fields.');
            }
        }

        function loadStudentApplications() {
            const applications = JSON.parse(localStorage.getItem('student-applications')) || [];
            document.getElementById('student-applications').innerHTML = applications.map(app => `
                <div class="medical-card p-4">
                    <h4 class="font-semibold">${app.name}</h4>
                    <span class="text-sm text-gray-500">${app.email}</span>
                    <div class="text-sm text-[var(--medical-primary)]">Bio: ${app.bio}</div>
                    <div class="text-sm text-gray-500">Status: ${app.status}</div>
                </div>
            `).join('');
        }

        function searchProfiles() {
            const query = document.getElementById('search-box').value.toLowerCase();
            const applications = JSON.parse(localStorage.getItem('student-applications')) || [];
            const results = applications.filter(app => app.name.toLowerCase().includes(query) || app.email.toLowerCase().includes(query));
            document.getElementById('search-results').innerHTML = results.map(app => `
                <div class="medical-card p-4">
                    <h4 class="font-semibold">${app.name}</h4>
                    <span class="text-sm text-gray-500">${app.email}</span>
                </div>
            `).join('');
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadStudentApplications();
            document.getElementById('search-box').addEventListener('input', searchProfiles);
        });
    </script>
</body>
</html>